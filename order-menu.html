<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order Menu | CRISPY KING</title>
  <meta name="description" content="Select your food and build your order at Crispy King.">
  <link rel="icon" href="images/chicken1.jpg" type="image/jpeg">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@700;900&family=Open+Sans:wght@400;600&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Bangers&display=swap">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css">
  <style>
    .order-cart-bar {
      position: fixed;
      left: 0; right: 0; bottom: 0;
      background: #fff;
      border-top: 2px solid var(--primary);
      box-shadow: 0 -4px 24px rgba(255,107,0,0.10);
      z-index: 2000;
      padding: 16px 0 16px 0;
    }
    .order-cart-bar .btn {
      min-width: 160px;
    }
    .order-cart-bar .cart-total {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--primary);
    }
    .menu-nav-modern .nav-link {
      border-radius: 50px;
      transition: background 0.2s;
    }
    .menu-nav-modern .nav-link.active, .menu-nav-modern .nav-link:focus, .menu-nav-modern .nav-link:hover {
      background: #0d6efd;
      color: #fff !important;
    }
    .menu-tab-btn {
      color: #0d6efd;
      border-radius: 50px;
      transition: background 0.2s;
    }
    .menu-tab-btn.active, .menu-tab-btn:focus, .menu-tab-btn:hover {
      background: #0d6efd;
      color: #fff !important;
      border-radius: 50px;
    }
    /* Add to cart feedback styles */
    .add-to-cart-feedback {
      z-index: 2100;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      font-weight: 600;
    }
    /* Menu card hover effect */
    .menu-card {
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .menu-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    /* Loading overlay */
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255,255,255,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 15px;
    }
    .menu-card {
      position: relative;
    }
    /* Quantity controls */
    .quantity-controls {
      display: none;
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255,255,255,0.95);
      padding: 5px;
      border-radius: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .menu-card:hover .quantity-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .quantity-btn {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      border: none;
      background: var(--primary);
      color: white;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s;
    }
    .quantity-btn:hover {
      transform: scale(1.1);
    }
    .quantity-display {
      font-weight: 600;
      min-width: 30px;
      text-align: center;
    }
    /* Mobile optimizations */
    @media (max-width: 768px) {
      .quantity-controls {
        display: flex;
        position: static;
        transform: none;
        margin-top: 10px;
        justify-content: center;
      }
      .menu-card {
        padding-bottom: 15px;
      }
    }
  </style>
  <script src="js/page-init.js" type="module"></script>
</head>
<body class="bg-white text-dark">
  <div id="navbar-container"></div>

  <!-- HERO SECTION -->
  <section class="hero parallax" style="background: #000;">
    <div class="container hero-content">
      <h1 class="hero-title"><span>Choose</span> <span>Your</span> <span>Food</span></h1>
      <p class="hero-subtitle">Tap to add items to your order. Total updates below!</p>
    </div>
    <div class="hero-overlay"></div>
  </section>
  <div class="section-divider"></div>

  <!-- REWARDS & DISCOUNTS -->
  <section class="py-4 bg-light">
    <div class="container">
      <div class="row g-4">
        <!-- Loyalty Program Status -->
        <div class="col-md-6">
          <div class="glass p-4" id="loyaltyCard">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h4 class="mb-0">Crispy Rewards</h4>
              <span class="badge bg-warning" id="loyaltyTier">Bronze</span>
            </div>
            <div class="points-info mb-3">
              <div class="d-flex justify-content-between align-items-center">
                <span>Available Points:</span>
                <span class="fs-4 text-primary" id="pointsBalance">0</span>
              </div>
              <div class="progress mt-2" style="height: 10px;">
                <div class="progress-bar bg-warning" id="tierProgress" role="progressbar" style="width: 0%"></div>
              </div>
              <small class="text-muted" id="nextTierInfo">500 points to Silver tier</small>
            </div>
            <div class="available-rewards mb-3">
              <h6>Available Rewards</h6>
              <ul class="list-unstyled" id="rewardsList">
                <!-- Populated by JS -->
              </ul>
            </div>
            <button class="btn w-100" data-bs-toggle="modal" data-bs-target="#rewardsModal">
              View All Benefits →
            </button>
          </div>
        </div>
        
        <!-- Student Discount -->
        <div class="col-md-6">
          <div class="glass p-4">
            <h4 class="mb-3">Student Discount</h4>
            <div id="studentVerification">
              <p>Are you a student? Get 15% off all orders!</p>
              <form id="studentForm" class="mb-3">
                <div class="input-group">
                  <input type="email" class="form-control" placeholder="Enter your student email" id="studentEmail" required>
                  <button class="btn btn-primary" type="submit">Verify</button>
                </div>
                <small class="text-muted d-block mt-1">Use your .ac.uk or .edu email</small>
              </form>
            </div>
            <div id="verifiedStudent" style="display: none;">
              <div class="alert alert-success">
                <i class="fas fa-check-circle me-2"></i>Student discount active
                <span class="badge bg-success ms-2">15% OFF</span>
              </div>
              <p class="mb-0 small">Discount automatically applied at checkout</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Rewards Modal -->
  <div class="modal fade" id="rewardsModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content glass">
        <div class="modal-header">
          <h5 class="modal-title">Crispy Rewards Benefits</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="tier-benefits">
            <div class="tier-card mb-3">
              <h6 class="d-flex align-items-center">
                <span class="badge bg-warning me-2">Bronze</span>
                <span>0-499 points</span>
              </h6>
              <ul class="list-unstyled mb-0 small">
                <li><i class="fas fa-check text-success me-2"></i>Earn 10 points per £1 spent</li>
                <li><i class="fas fa-check text-success me-2"></i>Birthday special offer</li>
              </ul>
            </div>
            <div class="tier-card mb-3">
              <h6 class="d-flex align-items-center">
                <span class="badge bg-secondary me-2">Silver</span>
                <span>500-999 points</span>
              </h6>
              <ul class="list-unstyled mb-0 small">
                <li><i class="fas fa-check text-success me-2"></i>15 points per £1 spent</li>
                <li><i class="fas fa-check text-success me-2"></i>Free delivery on orders over £15</li>
                <li><i class="fas fa-check text-success me-2"></i>Priority customer service</li>
              </ul>
            </div>
            <div class="tier-card">
              <h6 class="d-flex align-items-center">
                <span class="badge bg-warning me-2">Gold</span>
                <span>1000+ points</span>
              </h6>
              <ul class="list-unstyled mb-0 small">
                <li><i class="fas fa-check text-success me-2"></i>20 points per £1 spent</li>
                <li><i class="fas fa-check text-success me-2"></i>Free delivery on all orders</li>
                <li><i class="fas fa-check text-success me-2"></i>Exclusive monthly offers</li>
                <li><i class="fas fa-check text-success me-2"></i>Double points weekends</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MENU SELECTION SECTION -->
  <section class="py-5">
    <div class="container">
      <h2 class="text-center mb-4">Menu</h2>
      <ul class="nav nav-pills menu-nav-modern justify-content-center mb-4" id="menuTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link menu-tab-btn active" id="burgers-tab" data-bs-toggle="pill" data-bs-target="#burgers" type="button" role="tab">Burgers</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link menu-tab-btn" id="chips-tab" data-bs-toggle="pill" data-bs-target="#chips" type="button" role="tab">Chips</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link menu-tab-btn" id="chicken-tab" data-bs-toggle="pill" data-bs-target="#chicken" type="button" role="tab">Fried Chicken</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link menu-tab-btn" id="pizza-tab" data-bs-toggle="pill" data-bs-target="#pizza" type="button" role="tab">Pizza</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link menu-tab-btn" id="bbq-tab" data-bs-toggle="pill" data-bs-target="#bbq" type="button" role="tab">BBQ</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link menu-tab-btn" id="kids-tab" data-bs-toggle="pill" data-bs-target="#kids" type="button" role="tab">Kids Menu</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link menu-tab-btn" id="drinks-tab" data-bs-toggle="pill" data-bs-target="#drinks" type="button" role="tab">Drinks</button>
        </li>
      </ul>
      <div class="tab-content" id="menuTabContent">
        <!-- Burgers -->
        <div class="tab-pane fade show active" id="burgers" role="tabpanel">
          <div class="row justify-content-center">
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/chickenburger.jpg" alt="Chicken Burger" class="menu-img"><h5>Chicken Burger</h5><span class="price">£2.90</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/fishburger.jpg" alt="Fish Burger" class="menu-img"><h5>Fish Burger</h5><span class="price">£2.50</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/cheeseburger.jpg" alt="Cheese Burger" class="menu-img"><h5>Cheese Burger</h5><span class="price">£2.50</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/veggieburger.jpg" alt="Vegie Burger" class="menu-img"><h5>Vegie Burger</h5><span class="price">£2.50</span></div></div>
          </div>
        </div>
        <!-- Chips -->
        <div class="tab-pane fade" id="chips" role="tabpanel">
          <div class="row justify-content-center">
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/smallchips.jpg" alt="Small Chips" class="menu-img"><h5>Small Chips</h5><span class="price">£1.00</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/mediumchips.jpg" alt="Medium Chips" class="menu-img"><h5>Medium Chips</h5><span class="price">£1.50</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/largechips.jpg" alt="Large Chips" class="menu-img"><h5>Large Chips</h5><span class="price">£2.00</span></div></div>
          </div>
        </div>
        <!-- Fried Chicken -->
        <div class="tab-pane fade" id="chicken" role="tabpanel">
          <div class="row justify-content-center">
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/wingsbucket.jpg" alt="WINGS BUCKET" class="menu-img"><h5>WINGS BUCKET</h5><p>20 wings, 4 fries & Drink</p><span class="price">£15.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/4wings.jpg" alt="4 Wings" class="menu-img"><h5>4 Wings</h5><span class="price">£1.70</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/10pcschicken.jpg" alt="10pcs chicken" class="menu-img"><h5>10pcs chicken</h5><p>with chips</p><span class="price">£11.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/6pcschicken.jpg" alt="6 pcs chicken" class="menu-img"><h5>6 pcs chicken</h5><span class="price">£8.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/1pcchicken&chips.jpg" alt="1pc chicken & chips" class="menu-img"><h5>1pc chicken & chips</h5><span class="price">£2.40</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/8wings.jpg" alt="8 wings" class="menu-img"><h5>8 wings</h5><span class="price">£3.30</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/2pcschicken&chips.jpg" alt="2pcs chicken & chips" class="menu-img"><h5>2pcs chicken & chips</h5><span class="price">£3.70</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/3pcschicken&chips.jpg" alt="3pcs chicken & chips" class="menu-img"><h5>3pcs chicken & chips</h5><span class="price">£4.50</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/4pcschicken&chips.jpg" alt="4pcs chicken & chips" class="menu-img"><h5>4pcs chicken & chips</h5><span class="price">£5.30</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/10hotwings.jpg" alt="10 hot wings" class="menu-img"><h5>10 hot wings</h5><span class="price">£3.99</span></div></div>
          </div>
        </div>
        <!-- Kids Menu -->
        <div class="tab-pane fade" id="kids" role="tabpanel">
          <div class="row justify-content-center">
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/1pcChicken,fries&drink.jpg" alt="1 pc Chicken, fries & drink" class="menu-img"><h5>1 pc Chicken, fries & drink</h5><span class="price">£2.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/3hotwings,fries&drink.jpg" alt="3 hot wings, fries & drink" class="menu-img"><h5>3 hot wings, fries & drink</h5><span class="price">£2.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/3nuggets,fries&drink.jpg" alt="3 nuggets, fries & drink" class="menu-img"><h5>3 nuggets, fries & drink</h5><span class="price">£2.99</span></div></div>
          </div>
        </div>
        <!-- BBQ -->
        <div class="tab-pane fade" id="bbq" role="tabpanel">
          <div class="row justify-content-center">
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/6bbqlambribs.jpg" alt="6 BBQ lamb ribs" class="menu-img"><h5>6 BBQ lamb ribs</h5><span class="price">£6.50</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/bbqhotwings6pcs.jpg" alt="BBQ hot wings 6pcs" class="menu-img"><h5>BBQ hot wings 6pcs</h5><span class="price">£3.50</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/bbqhotwings10pcs.jpg" alt="BBQ hot wings 10pcs" class="menu-img"><h5>BBQ hot wings 10pcs</h5><span class="price">£5.00</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/10bbqlambribs.jpg" alt="10 BBQ lamb ribs" class="menu-img"><h5>10 BBQ lamb ribs</h5><span class="price">£7.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/4bbqlambribs.jpg" alt="4 BBQ lamb ribs" class="menu-img"><h5>4 BBQ lamb ribs</h5><span class="price">£4.50</span></div></div>
          </div>
        </div>
        <!-- Pizza -->
        <div class="tab-pane fade" id="pizza" role="tabpanel">
          <div class="row justify-content-center">
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/margheritapizza.jpg" alt="Margherita Pizza" class="menu-img"><h5>Margherita Pizza</h5><ul class="list-unstyled mb-1"><li>Medium 9" <span class="price">£8.99</span></li><li>Large 12" <span class="price">£11.99</span></li><li>Super 15" <span class="price">£14.99</span></li></ul><p>Classic cheese & tomato</p></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/pepperonipizza.jpg" alt="Pepperoni Pizza" class="menu-img"><h5>Pepperoni Pizza</h5><ul class="list-unstyled mb-1"><li>Medium 9" <span class="price">£10.99</span></li><li>Large 12" <span class="price">£13.99</span></li><li>Super 15" <span class="price">£16.99</span></li></ul><p>Double pepperoni & extra cheese</p></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/bbqpizza.jpg" alt="BBQ Pizza" class="menu-img"><h5>BBQ Pizza</h5><ul class="list-unstyled mb-1"><li>Medium 9" <span class="price">£10.99</span></li><li>Large 12" <span class="price">£13.99</span></li><li>Super 15" <span class="price">£16.99</span></li></ul><p>BBQ sauce, chicken, onions, peppers</p></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/VegetarianPizza.jpg" alt="Vegetarian Pizza" class="menu-img"><h5>Vegetarian Pizza</h5><ul class="list-unstyled mb-1"><li>Medium 9" <span class="price">£9.99</span></li><li>Large 12" <span class="price">£12.99</span></li><li>Super 15" <span class="price">£15.99</span></li></ul><p>Mushrooms, peppers, sweetcorn, tomato</p></div></div>
          </div>
        </div>
        <!-- Drinks -->
        <div class="tab-pane fade" id="drinks" role="tabpanel">
          <div class="row justify-content-center">
            <div class="col-12 mb-3"><h5 class="fw-bold">Bottled Drinks (1.5L)</h5></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/7up1.5l.jpg" alt="7UP 1.5L" class="menu-img"><h5>7UP 1.5L</h5><span class="price">£2.70</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/coke1.5l.jpg" alt="Coke 1.5L" class="menu-img"><h5>Coke 1.5L</h5><span class="price">£2.70</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/pepsi1.5l.jpg" alt="Pepsi 1.5L" class="menu-img"><h5>Pepsi 1.5L</h5><span class="price">£2.70</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/dietcoke1.5l.jpg" alt="Diet Coke 1.5L" class="menu-img"><h5>Diet Coke 1.5L</h5><span class="price">£2.70</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/tango1.5l.jpg" alt="Tango 1.5L" class="menu-img"><h5>Tango 1.5L</h5><span class="price">£2.70</span></div></div>
            <div class="col-12 mt-4 mb-3"><h5 class="fw-bold">Canned Drinks</h5></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/7upcan.jpg" alt="7UP Can" class="menu-img"><h5>7UP Can</h5><span class="price">£0.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/cokecan.jpg" alt="Coke Can" class="menu-img"><h5>Coke Can</h5><span class="price">£0.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/dietpepsican.jpg" alt="Diet Pepsi Can" class="menu-img"><h5>Diet Pepsi Can</h5><span class="price">£0.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/drpeppercan.jpg" alt="Dr Pepper Can" class="menu-img"><h5>Dr Pepper Can</h5><span class="price">£0.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/mirandaorangecan.jpg" alt="Miranda Orange Can" class="menu-img"><h5>Miranda Orange Can</h5><span class="price">£0.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/mirandastrawberrycan.jpg" alt="Miranda Strawberry Can" class="menu-img"><h5>Miranda Strawberry Can</h5><span class="price">£0.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/pepsican.jpg" alt="Pepsi Can" class="menu-img"><h5>Pepsi Can</h5><span class="price">£0.99</span></div></div>
            <div class="col-12 mt-4 mb-3"><h5 class="fw-bold">Soft Drinks</h5></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/pineapplecoconut.jpg" alt="Pineapple Coconut" class="menu-img"><h5>Pineapple Coconut</h5><span class="price">£0.99</span></div></div>
            <div class="col-md-4 mb-4"><div class="menu-card glass"><img src="images/RibenaBlackcurrant.jpg" alt="Ribena Blackcurrant" class="menu-img"><h5>Ribena Blackcurrant</h5><span class="price">£0.99</span></div></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CART BAR -->
  <div class="order-cart-bar d-flex justify-content-between align-items-center px-4" id="cartBar">
    <div class="cart-total">Total: £<span id="cartTotal">0.00</span></div>
    <button class="btn btn-lg btn-primary" id="checkoutBtn">Checkout</button>
  </div>

  <!-- Payment Integration -->
  <script src="https://sandbox.web.squarecdn.com/v1/square.js"></script>
  <script>
    async function initializeSquare() {
      const payments = Square.payments('sandbox-sq0idb-YOUR-SANDBOX-APP-ID', 'YOUR-LOCATION-ID');
      const card = await payments.card();
      await card.attach('#card-container');
    }
  </script>

  <!-- ORDER SECTION -->
  <section class="py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-8">
          <div class="menu-items">
            <!-- Existing menu items will be here -->
          </div>
        </div>
        <div class="col-md-4">
          <div class="order-summary glass p-4 sticky-top" style="top: 100px;">
            <h4 class="mb-3">Your Order</h4>
            <div id="cart-items" class="mb-3"></div>
            <div class="d-flex justify-content-between mb-3">
              <strong>Total:</strong>
              <span id="cart-total">£0.00</span>
            </div>
            <div id="card-container" class="mb-3">
              <!-- Square payment form will be injected here -->
            </div>
            <button class="btn btn-primary w-100" onclick="processPayment()">Pay & Place Order</button>
            <div class="mt-3">
              <small class="text-muted">🔒 Secure payment powered by Square</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
    // Initialize Square payment on page load
    document.addEventListener('DOMContentLoaded', async function() {
      try {
        await initializeSquare();
      } catch (e) {
        console.error('Failed to initialize Square:', e);
      }
    });

    async function processPayment() {
      // Demo implementation
      alert('Square payment integration is in demo mode.');
      window.location.href = 'delivery-tracker.html';
    }
  </script>

  <footer class="footer footer-gradient py-4 mt-5">
    <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center">
      <div><span class="fw-bold">Crispy King</span> &copy; 2025</div>
      <div class="footer-social">
        <a href="#" class="text-white mx-2"><i class="fab fa-facebook fa-lg"></i></a>
        <a href="#" class="text-white mx-2"><i class="fab fa-instagram fa-lg"></i></a>
        <a href="#" class="text-white mx-2"><i class="fab fa-x-twitter fa-lg"></i></a>
      </div>
      <div class="footer-hours"><i class="fas fa-clock"></i> Mon-Sun: 11am - 11pm</div>
    </div>
  </footer>

  <!-- Bootstrap Bundle JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
  <script src="js/loyalty.js"></script>
  <script src="js/cart.js"></script>
  <script src="js/script.js"></script>
  <script>
    AOS.init({ duration: 1200, once: true });

    // MENU DATA
    const menu = [
      // BURGERS
      { id: 1, category: 'Burgers', name: 'Chicken Burger', price: 2.90, desc: '' },
      { id: 2, category: 'Burgers', name: 'Fish Burger', price: 2.50, desc: '' },
      { id: 3, category: 'Burgers', name: 'Cheese Burger', price: 2.50, desc: '' },
      { id: 4, category: 'Burgers', name: 'Veggie Burger', price: 2.50, desc: '' },
      { id: 5, category: 'Burgers', name: '1/4 Pounder', price: 3.50, desc: '' },
      // FRIED CHICKEN
      { id: 10, category: 'Fried Chicken', name: 'WINGS BUCKET', price: 15.99, desc: '20 wings, 4 fries & Drink' },
      { id: 11, category: 'Fried Chicken', name: '4 Wings', price: 1.70, desc: '' },
      { id: 12, category: 'Fried Chicken', name: '10pcs chicken', price: 11.99, desc: 'with chips' },
      { id: 13, category: 'Fried Chicken', name: '6 pcs chicken', price: 8.99, desc: '' },
      { id: 14, category: 'Fried Chicken', name: '1pc chicken & chips', price: 2.40, desc: '' },
      { id: 15, category: 'Fried Chicken', name: '8 wings', price: 3.30, desc: '' },
      { id: 16, category: 'Fried Chicken', name: '2pcs chicken & chips', price: 3.70, desc: '' },
      { id: 17, category: 'Fried Chicken', name: '3pcs chicken & chips', price: 4.50, desc: '' },
      { id: 18, category: 'Fried Chicken', name: '4pcs chicken & chips', price: 5.30, desc: '' },
      { id: 19, category: 'Fried Chicken', name: '10 hot wings', price: 3.99, desc: '' },
      // KIDS MENU
      { id: 20, category: 'Kids Menu', name: '1 pc Chicken, fries & drink', price: 2.99, desc: '' },
      { id: 21, category: 'Kids Menu', name: '3 hot wings, fries & drink', price: 2.99, desc: '' },
      { id: 22, category: 'Kids Menu', name: '3 nuggets, fries & drink', price: 2.99, desc: '' },
      // BBQ
      { id: 30, category: 'BBQ', name: '6 BBQ lamb ribs', price: 6.50, desc: '' },
      { id: 31, category: 'BBQ', name: 'BBQ hot wings 6pcs', price: 3.50, desc: '' },
      { id: 32, category: 'BBQ', name: 'BBQ hot wings 10pcs', price: 5.00, desc: '' },
      { id: 33, category: 'BBQ', name: '10 BBQ lamb ribs', price: 7.99, desc: '' },
      { id: 34, category: 'BBQ', name: '4 BBQ lamb ribs', price: 4.50, desc: '' },
      // PIZZA (grouped by type with sizes)
      { id: 40, category: 'Pizza', name: 'Margherita Pizza', sizes: [ { size: 'Medium 9"', price: 8.99 }, { size: 'Large 12"', price: 11.99 }, { size: 'Super 15"', price: 14.99 } ], desc: 'Classic cheese & tomato' },
      { id: 41, category: 'Pizza', name: 'Pepperoni Pizza', sizes: [ { size: 'Medium 9"', price: 10.99 }, { size: 'Large 12"', price: 13.99 }, { size: 'Super 15"', price: 16.99 } ], desc: 'Double pepperoni & extra cheese' },
      { id: 42, category: 'Pizza', name: 'BBQ Pizza', sizes: [ { size: 'Medium 9"', price: 10.99 }, { size: 'Large 12"', price: 13.99 }, { size: 'Super 15"', price: 16.99 } ], desc: 'BBQ sauce, chicken, onions, peppers' },
      { id: 43, category: 'Pizza', name: 'Vegetarian Pizza', sizes: [ { size: 'Medium 9"', price: 9.99 }, { size: 'Large 12"', price: 12.99 }, { size: 'Super 15"', price: 15.99 } ], desc: 'Mushrooms, peppers, sweetcorn, tomato' },
      // DRINKS - Bottled
      { id: 50, category: 'Drinks', name: '7UP 1.5L', price: 2.70, desc: 'Bottled Drink' },
      { id: 51, category: 'Drinks', name: 'Coke 1.5L', price: 2.70, desc: 'Bottled Drink' },
      { id: 52, category: 'Drinks', name: 'Pepsi 1.5L', price: 2.70, desc: 'Bottled Drink' },
      { id: 53, category: 'Drinks', name: 'Diet Coke 1.5L', price: 2.70, desc: 'Bottled Drink' },
      { id: 54, category: 'Drinks', name: 'Tango 1.5L', price: 2.70, desc: 'Bottled Drink' },
      // DRINKS - Cans
      { id: 60, category: 'Drinks', name: '7UP Can', price: 0.99, desc: 'Canned Drink' },
      { id: 61, category: 'Drinks', name: 'Coke Can', price: 0.99, desc: 'Canned Drink' },
      { id: 62, category: 'Drinks', name: 'Diet Pepsi Can', price: 0.99, desc: 'Canned Drink' },
      { id: 63, category: 'Drinks', name: 'Dr Pepper Can', price: 0.99, desc: 'Canned Drink' },
      { id: 64, category: 'Drinks', name: 'Miranda Orange Can', price: 0.99, desc: 'Canned Drink' },
      { id: 65, category: 'Drinks', name: 'Miranda Strawberry Can', price: 0.99, desc: 'Canned Drink' },
      { id: 66, category: 'Drinks', name: 'Pepsi Can', price: 0.99, desc: 'Canned Drink' },
      // DRINKS - Soft
      { id: 70, category: 'Drinks', name: 'Pineapple Coconut', price: 0.99, desc: 'Soft Drink' },
      { id: 71, category: 'Drinks', name: 'Ribena Blackcurrant', price: 0.99, desc: 'Soft Drink' }
    ];

    // TABS & RENDERING
    const categories = [
      { key: 'Burgers', label: 'Burgers' },
      { key: 'Fried Chicken', label: 'Fried Chicken' },
      { key: 'Pizza', label: 'Pizza' },
      { key: 'BBQ', label: 'BBQ' },
      { key: 'Kids Menu', label: 'Kids Menu' },
      { key: 'Drinks', label: 'Drinks' }
    ];

    let activeTab = 'Burgers'; // Track active tab

    // Get cart for item quantity checks
    function getQty(id, size = null) {
      const itemKey = size ? `${id}_${size}` : id;
      const cart = JSON.parse(localStorage.getItem('ck_cart') || '[]');
      const item = cart.find(item => item.key === itemKey);
      return item ? item.qty : 0;
    }

    // Update quantities without full re-render
    function updateQuantities() {
      // Update all quantity displays
      document.querySelectorAll('[data-qty-id]').forEach(qtySpan => {
        const id = qtySpan.dataset.qtyId;
        const size = qtySpan.dataset.qtySize || null;
        qtySpan.textContent = getQty(id, size);
      });
      
      // Update cart total
      const cart = JSON.parse(localStorage.getItem('ck_cart') || '[]');
      const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);
      document.getElementById('cartTotal').textContent = total.toFixed(2);
    }
    
    window.updateMenu = updateQuantities; // Make it available to cart.js

    function renderTabs() {
      const tabNav = document.getElementById('menuTab');
      const tabContent = document.getElementById('menuTabContent');
      tabNav.innerHTML = '';
      tabContent.innerHTML = '';
      
      categories.forEach((cat, idx) => {
        const isActive = cat.key === activeTab;
        tabNav.innerHTML += `<li class="nav-item" role="presentation">
          <button class="nav-link menu-tab-btn${isActive?' active':''}" id="${cat.key}-tab" data-bs-toggle="pill" data-bs-target="#${cat.key.replace(/\s/g,'')}" type="button" role="tab" onclick="activeTab='${cat.key}'">${cat.label}</button>
        </li>`;          const items = menu.filter(i => i.category === cat.key);
        let content = '';
        
        if(cat.key === 'Pizza') {
          items.forEach(item => {
            let imgFile = item.name.replace(/\s+/g, '').toLowerCase();
            if(item.name === 'Margherita Pizza') imgFile = '../images/margheritapizza.jpg';
            else if(item.name === 'Pepperoni Pizza') imgFile = '../images/pepperonipizza.jpg';
            else if(item.name === 'BBQ Pizza') imgFile = '../images/bbqpizza.jpg';
            else if(item.name === 'Vegetarian Pizza') imgFile = 'VegetarianPizza.jpg';
            
            content += `<div class='col-md-6 mb-4'>
              <div class='menu-card glass text-center h-100 d-flex flex-column justify-content-between'>
                ${imgFile?`<img src='../images/${imgFile}' alt='${item.name}' class='menu-img mb-2'>`:''}
                <h5>${item.name}</h5>
                <p class="mb-1">${item.desc}</p>
                <ul class='list-unstyled mb-1'>`;
            
            item.sizes.forEach(s => {
              const sizeKey = `${item.id}_${s.size.replace(/"/g, '')}`;
              const qty = getQty(item.id, s.size.replace(/"/g, ''));
              content += `<li class="mb-2">
                ${s.size} <span class='price'>£${s.price.toFixed(2)}</span>
                <div class='d-inline-flex align-items-center ms-2'>
                  <button class='btn btn-sm btn-outline-primary' onclick='addToCart(${item.id},"${item.name}",${s.price},"${s.size.replace(/"/g, '')}")'>+</button>
                  <span class='mx-2' data-qty-id="${item.id}" data-qty-size="${s.size.replace(/"/g, '')}">${qty}</span>
                  <button class='btn btn-sm btn-outline-danger' onclick='removeFromCart(${item.id},"${s.size.replace(/"/g, '')}")'>-</button>
                </div>
              </li>`;
            });
            content += `</ul></div></div>`;
          });
        } else if(cat.key === 'Drinks') {
          const drinkGroups = [
            { label: 'Bottled Drinks (1.5L)', desc: 'Bottled Drink' },
            { label: 'Canned Drinks', desc: 'Canned Drink' },
            { label: 'Soft Drinks', desc: 'Soft Drink' }
          ];
          drinkGroups.forEach(group => {
            const groupItems = items.filter(i => i.desc === group.desc);
            if(groupItems.length > 0) {
              content += `<div class='col-12 mb-3 mt-4'><h5 class='fw-bold'>${group.label}</h5></div>`;
              groupItems.forEach(item => {
                let imgFile = '';
                if(item.name === 'Ribena Blackcurrant') imgFile = 'RibenaBlackcurrant.jpg';
                else if(item.name === 'Pineapple Coconut') imgFile = 'pineapplecoconut.jpg';
                else if(item.name === 'Miranda Orange Can') imgFile = 'mirandaorangecan.jpg';
                else if(item.name === 'Miranda Strawberry Can') imgFile = 'mirandastrawberrycan.jpg';
                else if(item.name === 'Diet Pepsi Can') imgFile = 'dietpepsican.jpg';
                else if(item.name === 'Dr Pepper Can') imgFile = 'drpeppercan.jpg';
                else if(item.name === 'Coke 1.5L') imgFile = 'coke1.5l.jpg';
                else if(item.name === 'Diet Coke 1.5L') imgFile = 'dietcoke1.5l.jpg';
                else if(item.name === 'Pepsi 1.5L') imgFile = 'pepsi1.5l.jpg';
                else if(item.name === '7UP 1.5L') imgFile = '7up1.5l.jpg';
                else if(item.name === 'Tango 1.5L') imgFile = 'tango1.5l.jpg';
                else if(item.name === 'Coke Can') imgFile = 'cokecan.jpg';
                else if(item.name === 'Pepsi Can') imgFile = 'pepsican.jpg';
                else if(item.name === '7UP Can') imgFile = '7upcan.jpg';
                
                const qty = getQty(item.id);
                content += `<div class='col-md-4 mb-4'><div class='menu-card glass text-center h-100 d-flex flex-column justify-content-between'>  <img src='../images/${imgFile}' alt='${item.name}' class='menu-img'><h5>${item.name}</h5><span class='price'>£${item.price.toFixed(2)}</span><div class='d-flex justify-content-center align-items-center mb-2'><button class='btn btn-sm btn-outline-primary ms-2' onclick='addToCart(${item.id},"${item.name}",${item.price})'>+</button><span class='mx-2' data-qty-id="${item.id}">${qty}</span><button class='btn btn-sm btn-outline-danger' onclick='removeFromCart(${item.id})'>-</button></div></div></div>`;
              });
            }
          });
        } else {
          items.forEach(item => {
            let imgFile = '';
            if(item.name === 'Chicken Burger') imgFile = 'chickenburger.jpg';
            else if(item.name === 'Fish Burger') imgFile = 'fishburger.jpg';
            else if(item.name === 'Cheese Burger') imgFile = 'cheeseburger.jpg';
            else if(item.name === 'Veggie Burger') imgFile = 'veggieburger.jpg';
            else if(item.name === '1/4 Pounder') imgFile = '14pounder.jpg';
            else if(item.name === 'Small Chips') imgFile = 'smallchips.jpg';
            else if(item.name === 'Medium Chips') imgFile = 'mediumchips.jpg';
            else if(item.name === 'Large Chips') imgFile = 'largechips.jpg';
            else if(item.name === 'WINGS BUCKET') imgFile = 'wingsbucket.jpg';
            else if(item.name === '4 Wings') imgFile = '4wings.jpg';
            else if(item.name === '10pcs chicken') imgFile = '10pcschicken.jpg';
            else if(item.name === '6 pcs chicken') imgFile = '6pcschicken.jpg';
            else if(item.name === '1pc chicken & chips') imgFile = '1pcchicken&chips.jpg';
            else if(item.name === '8 wings') imgFile = '8wings.jpg';
            else if(item.name === '2pcs chicken & chips') imgFile = '2pcschicken&chips.jpg';
            else if(item.name === '3pcs chicken & chips') imgFile = '3pcschicken&chips.jpg';
            else if(item.name === '4pcs chicken & chips') imgFile = '4pcschicken&chips.jpg';
            else if(item.name === '10 hot wings') imgFile = '10hotwings.jpg';
            else if(item.name === '1 pc Chicken, fries & drink') imgFile = '1pcChicken,fries&drink.jpg';
            else if(item.name === '3 hot wings, fries & drink') imgFile = '3hotwings,fries&drink.jpg';
            else if(item.name === '3 nuggets, fries & drink') imgFile = '3nuggets,fries&drink.jpg';
            else if(item.name === '6 BBQ lamb ribs') imgFile = '6bbqlambribs.jpg';
            else if(item.name === 'BBQ hot wings 6pcs') imgFile = 'bbqhotwings6pcs.jpg';
            else if(item.name === 'BBQ hot wings 10pcs') imgFile = 'bbqhotwings10pcs.jpg';
            else if(item.name === '10 BBQ lamb ribs') imgFile = '10bbqlambribs.jpg';
            else if(item.name === '4 BBQ lamb ribs') imgFile = '4bbqlambribs.jpg';
            
            const qty = getQty(item.id);
            content += `<div class='col-md-4 mb-4'><div class='menu-card glass text-center h-100 d-flex flex-column justify-content-between'>${imgFile?`<img src='../images/${imgFile}' alt='${item.name}' class='menu-img mb-2'>`:''}<h5>${item.name}</h5>${item.desc?`<p>${item.desc}</p>`:''}<span class='price'>£${item.price.toFixed(2)}</span><div class='d-flex justify-content-center align-items-center mb-2'><button class='btn btn-sm btn-outline-primary ms-2' onclick='addToCart(${item.id},"${item.name}",${item.price})'>+</button><span class='mx-2' data-qty-id="${item.id}">${qty}</span><button class='btn btn-sm btn-outline-danger' onclick='removeFromCart(${item.id})'>-</button></div></div></div>`;
          });
        }
        tabContent.innerHTML += `<div class="tab-pane fade${isActive?' show active':''}" id="${cat.key.replace(/\s/g,'')}" role="tabpanel"><div class="row justify-content-center">${content}</div></div>`;
      });

      // Re-initialize Bootstrap tabs
      const triggerTabList = [].slice.call(document.querySelectorAll('[data-bs-toggle="pill"]'));
      triggerTabList.forEach(function (triggerEl) {
        new bootstrap.Tab(triggerEl);
      });
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Get active tab from window.location.hash or localStorage
      const hash = window.location.hash;
      if (hash) {
        activeTab = categories.find(c => c.key.replace(/\s/g,'') === hash.substring(1))?.key || 'Burgers';
      } else {
        activeTab = localStorage.getItem('activeTab') || 'Burgers';
      }
      
      // Initialize
      window.renderTabs = renderTabs;
      renderTabs();
      
      // Set up tab change listener
      const tabEls = document.querySelectorAll('[data-bs-toggle="pill"]');
      tabEls.forEach(tabEl => {
        tabEl.addEventListener('shown.bs.tab', function (event) {
          activeTab = event.target.textContent;
          localStorage.setItem('activeTab', activeTab);
        });
      });
    });

    document.getElementById('checkoutBtn').onclick = function() {
      window.location.href = 'checkout.html';
    };
  </script>
</body>
</html>
